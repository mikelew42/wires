var is = require("is");
var Base = require("base42");


var Mfn = Base.extend({
	name: "Mfn",
	init: function(){
		var self = this;
		this.fn = function(){
			return self.main.apply(self, [this].concat([].slice.call(arguments)));
		};
		this.fn.mfn = this;
		this.fn.set = function(o){
			var NewMfn = this.mfn.constructor.extend.apply(this.mfn.constructor, arguments);
			return new NewMfn().fn;
		};
	},
	main: function(ctx){
		var args = this.args(arguments); // just chops off the first argument, the ctx, so you can "apply" the args
	},
	args: function(args){
		return [].slice.call(args, 1);
	}
}).assign({
	make: function(){
		var NewMfn = this.extend.apply(this, arguments);
		return NewMfn().fn;
	}
});

module.exports = Mfn;

/*
Regarding .make():
Due to the way we're using .set to copy the .fn via the constructor, we need to keep all modifications on the Mfn prototypes, not on mfn instances. 
*/